ê
wD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Contexts\PrivateGalleryDbContext.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Contexts %
{ 
public 

class #
PrivateGalleryDbContext (
:) *
IdentityDbContext+ <
<< =
User= A
>A B
{		 
public

 #
PrivateGalleryDbContext

 &
(

& '
)

' (
: 
base 
( 
$str '
,' (
throwIfV1Schema) 8
:8 9
false: ?
)? @
{ 	
} 	
public 
static #
PrivateGalleryDbContext -
Create. 4
(4 5
)5 6
{ 	
return 
new #
PrivateGalleryDbContext .
(. /
)/ 0
;0 1
} 	
public 
virtual 
DbSet 
< 
Folder #
># $
Folders% ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
virtual 
DbSet 
< 
File !
>! "
Files# (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public 
virtual 
DbSet 
< 
	Attribute &
>& '

Attributes( 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
	protected 
override 
void 
OnModelCreating  /
(/ 0
DbModelBuilder0 >
modelBuilder? K
)K L
{ 	
base 
. 
OnModelCreating  
(  !
modelBuilder! -
)- .
;. /
modelBuilder 
. 
Entity 
<  
	Attribute  )
>) *
(* +
)+ ,
. 
Property 
( 
attr 
=> !
attr" &
.& '
Id' )
)) *
. &
HasDatabaseGeneratedOption +
(+ ,#
DatabaseGeneratedOption, C
.C D
IdentityD L
)L M
;M N
modelBuilder   
.   
Entity   
<    
User    $
>  $ %
(  % &
)  & '
.  ' (
HasMany  ( /
(  / 0
u  0 1
=>  2 4
u  5 6
.  6 7
	Galleries  7 @
)  @ A
.  A B
WithRequired  B N
(  N O
g  O P
=>  Q S
g  T U
.  U V
	OwnerUser  V _
)  _ `
;  ` a
}!! 	
}"" 
}## Î
iD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Entities\Attribute.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Entities %
{ 
public 

class 
	Attribute 
{ 
[ 	
Key	 
] 
public		 
int		 
Id		 
{		 
get		 
;		 
set		  
;		  !
}		" #
public

 
bool

 
HasPublicAccess

 #
{

$ %
get

& )
;

) *
set

+ .
;

. /
}

0 1
=

2 3
false

4 9
;

9 :
} 
} «
fD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Entities\Folder.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Entities %
{		 
public

 

class

 
Folder

 
{ 
[ 	
Key	 
, 
Index 
( 
IsUnique 
= 
true #
)# $
]$ %
public 
string 
Id 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
Header 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 
CreatedDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 	
Required	 
] 
public 
virtual 
	Attribute  
	Attribute! *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
=9 :
new; >
	Attribute? H
(H I
)I J
;J K
[ 	
Required	 
] 
public 
virtual 
User 
	OwnerUser %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
virtual 
List 
< 
File  
>  !
Files" '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
=6 7
new8 ;
List< @
<@ A
FileA E
>E F
(F G
)G H
;H I
public 
virtual 
Folder 
ParentFolder *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
} ´
dD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Entities\File.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Entities %
{ 
public 

class 
File 
{ 
[		 	
Key			 
,		 
Index		 
(		 
IsUnique		 
=		 
true		 #
)		# $
]		$ %
public

 
string

 
Id

 
{

 
get

 
;

 
set

  #
;

# $
}

% &
public 
string 
Header 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 
CreatedDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 	
Required	 
] 
public 
virtual 
	Attribute  
	Attribute! *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
=9 :
new; >
	Attribute? H
(H I
)I J
;J K
public 
string 
Path 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Geolocation !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
virtual 
Folder 
ParentFolder *
{+ ,
get- 0
;0 1
set2 5
;5 6
}7 8
} 
} æ
mD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Entities\FileStructure.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Entities %
{ 
public 

class 
FileStructure 
{		 
[

 	
Key

	 
,

 
Index

 
(

 
IsClustered

 
=

  
false

! &
)

& '
]

' (
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
Header 
{ 
get "
;" #
set$ '
;' (
}) *
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
DateTime 
? 
CreatedDate $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 	
Required	 
] 
public 
	Attribute 
	Attribute "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
new3 6
	Attribute7 @
(@ A
)A B
;B C
public 
string 
Path 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Geolocation !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 	
Index	 
( 
IsClustered 
= 
true !
,! "
Order" '
=( )
$num* +
)+ ,
], -
public 
virtual 
Folder 
Folder $
{% &
get' *
;* +
set, /
;/ 0
}1 2
[ 	
Required	 
] 
public 
virtual 
User 
	OwnerUser %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
public 
virtual 
List 
< 
File  
>  !
Files" '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
=6 7
new8 ;
List< @
<@ A
FileA E
>E F
(F G
)G H
;H I
} 
} §
dD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Entities\User.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Entities %
{ 
public		 

class		 
User		 
:		 
IdentityUser		 $
{

 
public 
async 
Task 
< 
ClaimsIdentity (
>( )%
GenerateUserIdentityAsync* C
(C D
UserManagerD O
<O P
UserP T
>T U
managerV ]
,] ^
string 
authenticationType %
)% &
{ 	
var 
userIdentity 
= 
await $
manager% ,
., -
CreateIdentityAsync- @
(@ A
thisA E
,E F
authenticationTypeG Y
)Y Z
;Z [
return 
userIdentity 
;  
} 	
public 
string 

AvatarPath  
{! "
get# &
;& '
set( +
;+ ,
}- .
=/ 0
null1 5
;5 6
public 
string 
	FirstName 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
LastName 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
virtual 
List 
< 
Folder "
>" #
	Galleries$ -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
=< =
new> A
ListB F
<F G
FolderG M
>M N
(N O
)O P
;P Q
} 
} · 
vD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Infrastructure\DalEntityCreator.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Infrastructure +
{ 
public 

static 
class 
DalEntityCreator (
{ 
public 
static 
Folder 
CreateGalleryEntity 0
(0 1
GalleryBindindModel1 D
modelE J
)J K
=>L N
newO R
FolderS Y
{ 	
Id 
= 
$" 
{ 
model 
. 
Name 
} 
{  
DateTime  (
.( )
Now) ,
., -
Ticks- 2
}2 3
"3 4
,4 5
ParentFolder 
= 
string !
.! "
IsNullOrEmpty" /
(/ 0
model0 5
.5 6
ParentId6 >
)> ?
? 
null 
: 

UnitOfWork 
. 
Instance %
.% &
FolderRepository& 6
.6 7
Get7 :
(: ;
x; <
=>= ?
x@ A
.A B
IdB D
==E G
modelH M
.M N
ParentIdN V
)V W
,W X
CreatedDate 
= 
model 
.  
DateTime  (
,( )
Header 
= 
model 
. 
Name 
,  
	Attribute 
= 
model 
. 
	Attribute '
==( *
null+ /
? 
new 
	Attribute 
(  
)  !
: 
new 
	Attribute 
(  
)  !
{" #
HasPublicAccess# 2
=3 4
model5 :
.: ;
	Attribute; D
.D E
HasPublicAccessE T
}T U
} 	
;	 

public 
static 
File 
CreatePhotoEntity ,
(, -
PictureBindingModel- @
modelA F
)F G
=>H J
newK N
FileO S
{ 	
Id 
= 
$" 
{ 
model 
. 
Name 
} 
{  
DateTime  (
.( )
Now) ,
., -
Ticks- 2
}2 3
"3 4
,4 5
ParentFolder 
= 
string !
.! "
IsNullOrEmpty" /
(/ 0
model0 5
.5 6
ParentId6 >
)> ?
? 
null 
:   

UnitOfWork   
.   
Instance   %
.  % &
FolderRepository  & 6
.  6 7
Get  7 :
(  : ;
x  ; <
=>  = ?
x  @ A
.  A B
Id  B D
==  E G
model  H M
.  M N
ParentId  N V
)  V W
,  W X
Header!! 
=!! 
model!! 
.!! 
Name!! 
,!!  
Description"" 
="" 
model"" 
.""  
Description""  +
,""+ ,
Geolocation## 
=## 
model## 
.##  
Geolocation##  +
,##+ ,
CreatedDate$$ 
=$$ 
model$$ 
.$$  
DateTime$$  (
,$$( )
	Attribute%% 
=%% 
model%% 
.%% 
	Attribute%% '
==%%( *
null%%+ /
?&& 
new&& 
	Attribute&& 
(&&  
)&&  !
:'' 
new'' 
	Attribute'' 
{''  !
HasPublicAccess''! 0
=''1 2
model''3 8
.''8 9
	Attribute''9 B
.''B C
HasPublicAccess''C R
}''R S
}(( 	
;((	 

})) 
}** §	
oD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Migrations\Configuration.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 

Migrations '
{ 
internal 
sealed 
class 
Configuration '
:( )%
DbMigrationsConfiguration* C
<C D
PrivateGalleryD R
.R S
DALS V
.V W
ContextsW _
._ `#
PrivateGalleryDbContext` w
>w x
{		 
public

 
Configuration

 
(

 
)

 
{ 	&
AutomaticMigrationsEnabled &
=' (
true) -
;- .

ContextKey 
= 
$str N
;N O
} 	
	protected 
override 
void 
Seed  $
($ %
PrivateGallery% 3
.3 4
DAL4 7
.7 8
Contexts8 @
.@ A#
PrivateGalleryDbContextA X
contextY `
)` a
{ 	
} 	
} 
}   ô
nD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str -
)- .
]. /
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str /
)/ 0
]0 1
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *€!
tD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Repositories\FolderRepository.cs
	namespace

 	
PrivateGallery


 
.

 
DAL

 
.

 
Repositories

 )
{ 
internal 
class 
FolderRepository #
:$ %
RepositoryBase& 4
<4 5
Folder5 ;
>; <
{ 
public 
FolderRepository 
(  #
PrivateGalleryDbContext  7
context8 ?
)? @
:A B
baseC G
(G H
contextH O
)O P
{ 	
} 	
public 
override 
void 
Update #
(# $
Folder$ *
item+ /
)/ 0
=>1 3
Context4 ;
.; <
Entry< A
(A B
itemB F
)F G
.G H
StateH M
=N O
EntityStateP [
.[ \
Modified\ d
;d e
public 
override 
void 
Delete #
(# $
Func$ (
<( )
Folder) /
,/ 0
bool1 5
>5 6
func7 ;
); <
{ 	
var 
found 
= 
Context 
.  
Folders  '
. 
FirstOrDefault 
(  
func  $
)$ %
;% &
if 
( 
found 
!= 
null 
) 
{ 
var 
instance 
= 

UnitOfWork )
.) *
Instance* 2
;2 3
var 
list 
= 
found  
.  !
Files! &
;& '
while 
( 
list 
. 
Any 
(  
)  !
)! "
{ 
instance 
. 
FileRepository +
.+ ,
Delete, 2
(2 3
x3 4
=>5 7
x8 9
.9 :
Id: <
=== ?
list@ D
.D E
FirstE J
(J K
)K L
.L M
IdM O
)O P
;P Q
} 
Context 
. 

Attributes "
." #
Remove# )
() *
found* /
./ 0
	Attribute0 9
)9 :
;: ;
Context 
. 
Folders 
.  
Remove  &
(& '
found' ,
), -
;- .
}   
}!! 	
public"" 
override"" 
IEnumerable"" #
<""# $
Folder""$ *
>""* +
GetAll"", 2
(""2 3
)""3 4
=>""5 7
Context""8 ?
.""? @
Folders""@ G
;""G H
public## 
override## 
Folder## 
Get## "
(##" #
Func### '
<##' (
Folder##( .
,##. /
bool##0 4
>##4 5
func##6 :
)##: ;
=>##< >
Context##? F
.##F G
Folders##G N
.##N O
FirstOrDefault##O ]
(##] ^
func##^ b
)##b c
;##c d
public$$ 
override$$ 
Task$$ 
<$$ 
Folder$$ #
>$$# $
GetAsync$$% -
($$- .

Expression$$. 8
<$$8 9
Func$$9 =
<$$= >
Folder$$> D
,$$D E
bool$$F J
>$$J K
>$$K L
func$$M Q
)$$Q R
=>$$R T
Context$$U \
.$$\ ]
Folders$$] d
.$$d e
FirstOrDefaultAsync$$e x
($$x y
func$$y }
)$$} ~
;$$~ 
public%% 
override%% 
void%% 
Create%% #
(%%# $
Folder%%$ *
item%%+ /
)%%/ 0
=>%%1 3
Context%%4 ;
.%%; <
Folders%%< C
.%%C D
Add%%D G
(%%G H
item%%H L
)%%L M
;%%M N
}&& 
}'' ù
oD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Repositories\IRepository.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Repositories )
{ 
public		 

	interface		 
IRepository		  
<		  !
T		! "
>		" #
:		# $
IDisposable		$ /
where		0 5
T		6 7
:		7 8
class		8 =
{

 
IEnumerable 
< 
T 
> 
GetAll 
( 
) 
;  
T 	
Get
 
( 
Func 
< 
T 
, 
bool 
> 
func  
)  !
;! "
Task 
< 
T 
> 
GetAsync 
( 

Expression #
<# $
Func$ (
<( )
T) *
,* +
bool, 0
>0 1
>1 2
func3 7
)7 8
;8 9
void 
Create 
( 
T 
item 
) 
; 
void## 
Update## 
(## 
T## 
item## 
)## 
;## 
void(( 
Delete(( 
((( 
Func(( 
<(( 
T(( 
,(( 
bool(( 
>((  
func((! %
)((% &
;((& '
})) 
}** ∂%
rD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Repositories\FileRepository.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Repositories )
{ 
internal 
class 
FileRepository !
:" #
RepositoryBase$ 2
<2 3
File3 7
>7 8
{ 
public 
FileRepository 
( #
PrivateGalleryDbContext 5
context6 =
)= >
:? @
baseA E
(E F
contextF M
)M N
{ 	
} 	
public 
override 
void 
Update #
(# $
File$ (
item) -
)- .
=>/ 1
Context2 9
.9 :
Entry: ?
(? @
item@ D
)D E
.E F
StateF K
=L M
EntityStateN Y
.Y Z
ModifiedZ b
;b c
public 
override 
void 
Delete #
(# $
Func$ (
<( )
File) -
,- .
bool/ 3
>3 4
func5 9
)9 :
{ 	
var 
found 
= 
Context 
.  
Files  %
. 
FirstOrDefault 
(  
func  $
)$ %
;% &
if 
( 
found 
!= 
null 
) 
{ 
string 
main 
= 
	AppDomain '
.' (
CurrentDomain( 5
.5 6
BaseDirectory6 C
;C D
if 
( 
! 
string 
. 
IsNullOrEmpty )
() *
found* /
./ 0
Path0 4
)4 5
)5 6
{ 
var 
path 
= 
found $
.$ %
Path% )
;) *
var 
file 
= 
$" !
{! "
main" &
}& '
{' (
path( ,
., -
	TrimStart- 6
(6 7
$char7 :
): ;
}; <
"< =
;= >
var 
info 
= 
new "
FileInfo# +
(+ ,
file, 0
)0 1
;1 2
if   
(   
info   
.   
Exists   #
)  # $
{!! 
System"" 
."" 
IO"" !
.""! "
File""" &
.""& '
Delete""' -
(""- .
file"". 2
)""2 3
;""3 4
}## 
}$$ 
Context%% 
.%% 

Attributes%% "
.%%" #
Remove%%# )
(%%) *
found%%* /
.%%/ 0
	Attribute%%0 9
)%%9 :
;%%: ;
Context&& 
.&& 
Files&& 
.&& 
Remove&& $
(&&$ %
found&&% *
)&&* +
;&&+ ,
}'' 
}(( 	
public** 
override** 
IEnumerable** #
<**# $
File**$ (
>**( )
GetAll*** 0
(**0 1
)**1 2
=>**3 5
Context**6 =
.**= >
Files**> C
;**C D
public++ 
override++ 
File++ 
Get++  
(++  !
Func++! %
<++% &
File++& *
,++* +
bool++, 0
>++0 1
func++2 6
)++6 7
=>++8 :
Context++; B
.++B C
Files++C H
.++H I
FirstOrDefault++I W
(++W X
func++X \
)++\ ]
;++] ^
public,, 
override,, 
Task,, 
<,, 
File,, !
>,,! "
GetAsync,,# +
(,,+ ,

Expression,,, 6
<,,6 7
Func,,7 ;
<,,; <
File,,< @
,,,@ A
bool,,B F
>,,F G
>,,G H
func,,I M
),,M N
=>,,N P
Context,,Q X
.,,X Y
Files,,Y ^
.,,^ _
FirstOrDefaultAsync,,_ r
(,,r s
func,,s w
),,w x
;,,x y
public-- 
override-- 
void-- 
Create-- #
(--# $
File--$ (
item--) -
)--- .
=>--/ 1
Context--2 9
.--9 :
Files--: ?
.--? @
Add--@ C
(--C D
item--D H
)--H I
;--I J
}.. 
}// ¢
rD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Repositories\RepositoryBase.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Repositories )
{		 
internal

 
abstract

 
class

 
RepositoryBase

 *
<

* +
T

+ ,
>

, -
:

. /
IRepository

0 ;
<

; <
T

< =
>

= >
where

? D
T

E F
:

F G
class

G L
{ 
	protected #
PrivateGalleryDbContext )
Context* 1
;1 2
	protected 
RepositoryBase  
(  !#
PrivateGalleryDbContext! 8
context9 @
)@ A
=>B D
thisE I
.I J
ContextJ Q
=R S
contextT [
;[ \
public 
abstract 
void 
Delete #
(# $
Func$ (
<( )
T) *
,* +
bool, 0
>0 1
func2 6
)6 7
;7 8
public 
abstract 
T 
Get 
( 
Func "
<" #
T# $
,$ %
bool& *
>* +
func, 0
)0 1
;1 2
public 
abstract 
Task 
< 
T 
> 
GetAsync  (
(( )

Expression) 3
<3 4
Func4 8
<8 9
T9 :
,: ;
bool< @
>@ A
>A B
funcC G
)G H
;H I
public 
abstract 
void 
Create #
(# $
T$ %
item& *
)* +
;+ ,
public 
abstract 
IEnumerable $
<$ %
T% &
>& '
GetAll( .
(. /
)/ 0
;0 1
public 
abstract 
void 
Update #
(# $
T$ %
item& *
)* +
;+ ,
public 
void 
Dispose 
( 
) 
=>  
Context! (
?( )
.) *
Dispose* 1
(1 2
)2 3
;3 4
} 
} Ô
nD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Repositories\UnitOfWork.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Repositories )
{		 
public

 

class

 

UnitOfWork

 
:

 
IDisposable

 '
{ 
private 
static 
readonly #
PrivateGalleryDbContext  7
Context8 ?
=@ A
newB E#
PrivateGalleryDbContextF ]
(] ^
)^ _
;_ `
private 
static 
readonly 
Lazy  $
<$ %

UnitOfWork% /
>/ 0
_unitOfWork1 <
== >
new 
Lazy 
< 

UnitOfWork 
>  
(  ! 
LazyThreadSafetyMode! 5
.5 6#
ExecutionAndPublication6 M
)M N
;N O
public 
static 

UnitOfWork  
Instance! )
=>* ,
_unitOfWork- 8
.8 9
Value9 >
??? A
newB E
LazyF J
<J K

UnitOfWorkK U
>U V
(V W
)W X
.X Y
ValueY ^
;^ _
public 
IRepository 
< 
Folder !
>! "
FolderRepository# 3
{4 5
get6 9
;9 :
set; >
;> ?
}@ A
=B C
newD G
FolderRepositoryH X
(X Y
ContextY `
)` a
;a b
public 
IRepository 
< 
File 
>  
FileRepository! /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
=> ?
new@ C
FileRepositoryD R
(R S
ContextS Z
)Z [
;[ \
public 
IRepository 
< 
User 
>  
UserRepository! /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
=> ?
new@ C
UserRepositoryD R
(R S
ContextS Z
)Z [
;[ \
public 
void 
Save 
( 
) 
=> 
Context %
.% &
SaveChanges& 1
(1 2
)2 3
;3 4
public 
void 
	SaveAsync 
( 
) 
=>  "
Context# *
.* +
SaveChanges+ 6
(6 7
)7 8
;8 9
public 
void 
Dispose 
( 
) 
{ 	
FolderRepository 
? 
. 
Dispose %
(% &
)& '
;' (
FileRepository 
? 
. 
Dispose #
(# $
)$ %
;% &
UserRepository 
? 
. 
Dispose #
(# $
)$ %
;% &
} 	
} 
} ﬁ
rD:\Clouds\MegaNZ\Self-Development\Android_Xamarin\PrivateGallery\PrivateGallery.DAL\Repositories\UserRepository.cs
	namespace 	
PrivateGallery
 
. 
DAL 
. 
Repositories )
{ 
internal 
class 
UserRepository !
:" #
RepositoryBase$ 2
<2 3
User3 7
>7 8
{ 
public 
UserRepository 
( #
PrivateGalleryDbContext 5
context6 =
)= >
:? @
baseA E
(E F
contextF M
)M N
{ 	
} 	
public 
override 
void 
Update #
(# $
User$ (
item) -
)- .
=>/ 1
Context2 9
.9 :
Entry: ?
(? @
item@ D
)D E
.E F
StateF K
=L M
EntityStateN Y
.Y Z
ModifiedZ b
;b c
public 
override 
void 
Delete #
(# $
Func$ (
<( )
User) -
,- .
bool/ 3
>3 4
func5 9
)9 :
{ 	
var 
found 
= 
Context 
.  
Users  %
. 
FirstOrDefault 
(  
func  $
)$ %
;% &
if 
( 
found 
!= 
null 
) 
Context 
. 
Users 
. 
Remove $
($ %
found% *
)* +
;+ ,
} 	
public 
override 
IEnumerable #
<# $
User$ (
>( )
GetAll* 0
(0 1
)1 2
=>3 5
Context6 =
.= >
Users> C
;C D
public 
override 
User 
Get  
(  !
Func! %
<% &
User& *
,* +
bool, 0
>0 1
func2 6
)6 7
=>8 :
Context; B
.B C
UsersC H
.H I
FirstOrDefaultI W
(W X
funcX \
)\ ]
;] ^
public   
override   
Task   
<   
User   !
>  ! "
GetAsync  # +
(  + ,

Expression  , 6
<  6 7
Func  7 ;
<  ; <
User  < @
,  @ A
bool  B F
>  F G
>  G H
func  I M
)  M N
=>  O Q
Context  R Y
.  Y Z
Users  Z _
.  _ `
FirstOrDefaultAsync  ` s
(  s t
func!! 
)!! 
;!! 
public## 
override## 
void## 
Create## #
(### $
User##$ (
item##) -
)##- .
=>##/ 1
Context##2 9
.##9 :
Users##: ?
.##? @
Add##@ C
(##C D
item##D H
)##H I
;##I J
}$$ 
}%% 